#!/bin/bash

# Get current dir (bin dir)
BIN_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"
SSM_DIR="$BIN_DIR/.."
PUBKEY_DIR="$SSM_DIR/pubkeys"

keyid=$1
if [ -z $keyid ]; then
    echo "[ERROR] You must input a key ID, like so: bin/import_pubkey E1960A37"
    exit 1
fi
echo "[INFO] Importing key to pubkeys dir"
cmd=gpg --armor --export $keyid > $PUBKEY_DIR
echo $cmd
exit

echo "[INFO] Adding key ID to .ssm/gpg_keys"
echo $keyid >> gpg_keys

echo "[DONE]"